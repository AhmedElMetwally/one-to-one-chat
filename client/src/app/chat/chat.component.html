<h1 class="text-center hidden-xs">Real Time Chat</h1>
<h3 class="text-center visible-xs ">Real Time Chat</h3>
<hr>
<!-- panel-default -->
<div class="panel panel-default chat">
  <div class="panel-body">

    <div class="row">

      <!-- users -->
      <div class="col-md-3"  >
  
        <!-- check if users -->
        <div *ngIf="users.length" class="users" >
  
          <!-- clear the caller in click -->
          <button *ngIf='caller' style="margin-top:0;padding-top:2px;padding-bottom:2px" type="button" class="btn btn-danger center-block user" (click)="clearCaller()" >End Call </button>
         
          <!-- for loop users -->
          <div *ngFor="let user of users" >
            <!-- 
              onclick set this user in caller
              and set class danger remove success

              if click anther btn 
              set class success remove danger
              
             -->
            <button 
              [ngClass]=
              "{
                'btn-success' : user.socketId == caller?.socketId, 
                'btn-default' : user.socketId != caller?.socketId  
              }"
              class="btn  center-block user" 
              title='{{user.email}}' 
              (click)='call(user)'
            >
              {{user.name}}
              <!-- if user online -->
              <span *ngIf="user.online"  class="glyphicon glyphicon-send text-success"></span>
              <span *ngIf="!user.online"  class="glyphicon glyphicon-send"></span>
            </button>
          </div>
        </div>

        <!-- check if users -->
        <div *ngIf="!users.length" >
          <button class="btn btn-success center-block user">No  Users</button>
        </div>

      </div>
      <!-- end users -->

      <br>

      <!-- message body -->
      <div class="col-md-9 panel-body" *ngIf='caller'>

        <!-- messages -->
        <!-- scroll to end this div -->
        <div class="messages" #scrollMe [scrollTop]="scrollMe.scrollHeight">
          <div *ngFor="let message of messages" >
              <!-- message.user._id == _id  -> this user if owner this msg -->
            <p 
              class="lead msg "
              [ngClass]="{
                'me' : message.user._id == _id 
              }"
              (click)='message.showDate = !message.showDate'
            >
              {{message.content}}
              <br>
              <!-- 
                use undefind proparty to hide date
                on click convert this proparty 
              -->
              <span class="date" [hidden]='!message.showDate'>
                  {{message.created | date:'medium'}}
              </span>
            </p>
            
            
          </div>
        </div>
        <!-- end messages -->

        <br>
        
        <!-- form sent message -->
        <form method="post" (submit)='sent(msg)'>
          <div class="input-group">
            <input type="text" class="form-control" placeholder="Message...." #msg >
            <div class="input-group-btn">
              <button class="btn btn-primary" type="submit">Sent</button>
            </div>
          </div>
        </form>
        <!-- end form sent message -->

      </div>
      <!-- end message body -->

    </div>
  </div>

<!-- panel-default -->
</div> 
